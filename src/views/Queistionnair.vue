<script setup lang="ts">

import { ref } from 'vue';
import StepOne from '../components/questionnaire/StepOne.vue';
import StepTwo from '../components/questionnaire/StepTwo.vue';

import useFormStore from '../store/formStore';

export type IScope = {id:number,title:string,subscope:{id:number,title:string,questions:{title:string,rate:number,id:number}[]}[]}
const scope = ref([
    {
  id: 0,
  title: "IT и цифровые технологии",
  subscope: [
    {
      id: 0,
      title: "Frontend",
      questions: [
        { id: 0, title: "Насколько тебе нравится писать код?", rate: 1 },
        { id: 1, title: "Любишь ли ты делать сайты красивыми и удобными?", rate: 1 },
        { id: 2, title: "Интересен ли тебе JavaScript, HTML и CSS?", rate: 1 },
        { id: 3, title: "Готов ли ты работать с командой дизайнеров?", rate: 1 },
        { id: 4, title: "Нравится ли тебе реализовывать интерфейсы?", rate: 1 },
        { id: 5, title: "Комфортно ли тебе постоянно учиться новому?", rate: 1 },
        { id: 6, title: "Интересны ли тебе фреймворки (React, Vue)?", rate: 1 },
        { id: 7, title: "Умеешь ли ты тестировать интерфейсы?", rate: 1 },
        { id: 8, title: "Легко ли ты воспринимаешь обратную связь по дизайну?", rate: 1 },
        { id: 9, title: "Хочешь ли ты видеть результат своей работы сразу?", rate: 1 }
      ]
    },
    {
      id: 1,
      title: "Backend",
      questions: [
        { id: 10, title: "Любишь решать логические задачи?", rate: 1 },
        { id: 11, title: "Интересен ли тебе Python, Java или C#?", rate: 1 },
        { id: 12, title: "Хочешь обрабатывать данные и управлять логикой сайта?", rate: 1 },
        { id: 13, title: "Нравится ли тебе делать сложные системы?", rate: 1 },
        { id: 14, title: "Умеешь ли ты писать серверный код?", rate: 1 },
        { id: 15, title: "Интересно ли тебе работать с базами данных?", rate: 1 },
        { id: 16, title: "Готов ли ты разбираться в чужом коде?", rate: 1 },
        { id: 17, title: "Знаешь ли ты, как защитить данные пользователя?", rate: 1 },
        { id: 18, title: "Умеешь ли ты писать и проводить тесты?", rate: 1 },
        { id: 19, title: "Интересен ли тебе DevOps и CI/CD?", rate: 1 }
      ]
    },
    {
      id: 2,
      title: "Кибербезопасность",
      questions: [
        { id: 20, title: "Интересуешься ли ты хакерством и защитой данных?", rate: 1 },
        { id: 21, title: "Нравится ли тебе искать уязвимости?", rate: 1 },
        { id: 22, title: "Хочешь защищать системы от взломов?", rate: 1 },
        { id: 23, title: "Интересно ли тебе работать с логами и системами мониторинга?", rate: 1 },
        { id: 24, title: "Готов ли ты изучать стандарты безопасности?", rate: 1 },
        { id: 25, title: "Умеешь ли ты анализировать сетевой трафик?", rate: 1 },
        { id: 26, title: "Нравится ли тебе решать нестандартные задачи?", rate: 1 },
        { id: 27, title: "Интересуешься ли ты этичным хакингом?", rate: 1 },
        { id: 28, title: "Умеешь ли ты писать скрипты для автоматизации проверки безопасности?", rate: 1 },
        { id: 29, title: "Готов ли ты работать в критических ситуациях и быстро реагировать?", rate: 1 }
      ]
    }
  ]
},
{
  id: 1,
  title: "Техническая и инженерная сфера",
  subscope: [
    {
      id: 0,
      title: "Электроника",
      questions: [
        { id: 30, title: "Нравится ли тебе паять и работать с проводами?", rate: 1 },
        { id: 31, title: "Интересны ли тебе электрические схемы?", rate: 1 },
        { id: 32, title: "Готов ли ты разбираться в принципах работы микросхем?", rate: 1 },
        { id: 33, title: "Интересно ли тебе работать с Arduino или Raspberry Pi?", rate: 1 },
        { id: 34, title: "Нравится ли тебе искать неисправности в электронике?", rate: 1 },
        { id: 35, title: "Умеешь ли ты читать схемы?", rate: 1 },
        { id: 36, title: "Интересен ли тебе монтаж плат?", rate: 1 },
        { id: 37, title: "Хочешь создавать свои устройства?", rate: 1 },
        { id: 38, title: "Готов ли ты к мелкой ручной работе?", rate: 1 },
        { id: 39, title: "Интересны ли тебе физика и электротехника?", rate: 1 }
      ]
    },
    {
      id: 1,
      title: "Механика",
      questions: [
        { id: 40, title: "Нравится ли тебе собирать и разбирать механизмы?", rate: 1 },
        { id: 41, title: "Интересна ли тебе работа шестерёнок, моторов и рычагов?", rate: 1 },
        { id: 42, title: "Хочешь проектировать механизмы?", rate: 1 },
        { id: 43, title: "Интересна ли тебе инженерная графика и черчение?", rate: 1 },
        { id: 44, title: "Готов ли ты работать в CAD-программах?", rate: 1 },
        { id: 45, title: "Нравится ли тебе искать технические решения проблем?", rate: 1 },
        { id: 46, title: "Хочешь создавать свои конструкции?", rate: 1 },
        { id: 47, title: "Умеешь ли ты работать с инструментами?", rate: 1 },
        { id: 48, title: "Интересно ли тебе, как работают машины?", rate: 1 },
        { id: 49, title: "Любишь ли ты точные измерения и расчёты?", rate: 1 }
      ]
    },
    {
      id: 2,
      title: "Робототехника",
      questions: [
        { id: 50, title: "Интересны ли тебе роботы и умные устройства?", rate: 1 },
        { id: 51, title: "Готов ли ты совмещать механику и программирование?", rate: 1 },
        { id: 52, title: "Хочешь создавать устройства, которые что-то делают сами?", rate: 1 },
        { id: 53, title: "Интересна ли тебе автоматизация процессов?", rate: 1 },
        { id: 54, title: "Готов ли ты разбираться в сенсорах и микроконтроллерах?", rate: 1 },
        { id: 55, title: "Нравится ли тебе программировать физические устройства?", rate: 1 },
        { id: 56, title: "Хочешь участвовать в соревнованиях по робототехнике?", rate: 1 },
        { id: 57, title: "Умеешь ли ты тестировать и отлаживать системы?", rate: 1 },
        { id: 58, title: "Интересен ли тебе IoT и умные дома?", rate: 1 },
        { id: 59, title: "Нравится ли тебе видеть, как твои роботы выполняют задачи?", rate: 1 }
      ]
    }
  ]
},
{
  "id": 2,
  "title": "Строительство и архитектура",
  "subscope": [
    {
      "id": 0,
      "title": "Архитектура",
      "questions": [
        { "id": 60, "title": "Любишь ли ты рисовать и проектировать здания?", "rate": 1 },
        { "id": 61, "title": "Интересна ли тебе история архитектуры?", "rate": 1 },
        { "id": 62, "title": "Умеешь ли ты работать с чертежами?", "rate": 1 },
        { "id": 63, "title": "Готов ли ты изучать строительные нормы?", "rate": 1 },
        { "id": 64, "title": "Интересны ли тебе 3D-программы и макеты?", "rate": 1 },
        { "id": 65, "title": "Хочешь создавать красивые и функциональные пространства?", "rate": 1 },
        { "id": 66, "title": "Нравится ли тебе планировать городскую среду?", "rate": 1 },
        { "id": 67, "title": "Умеешь ли ты работать в команде с инженерами и дизайнерами?", "rate": 1 },
        { "id": 68, "title": "Интересен ли тебе интерьер и экстерьер зданий?", "rate": 1 },
        { "id": 69, "title": "Готов ли ты к длительным и точным расчётам?", "rate": 1 }
      ]
    },
    {
      "id": 1,
      "title": "Строительство",
      "questions": [
        { "id": 70, "title": "Нравится ли тебе работать руками?", "rate": 1 },
        { "id": 71, "title": "Интересны ли тебе строительные технологии?", "rate": 1 },
        { "id": 72, "title": "Готов ли ты работать на открытом воздухе?", "rate": 1 },
        { "id": 73, "title": "Умеешь ли ты работать с инструментами?", "rate": 1 },
        { "id": 74, "title": "Интересует ли тебя укладка фундамента и возведение стен?", "rate": 1 },
        { "id": 75, "title": "Хочешь видеть реальные результаты своей работы?", "rate": 1 },
        { "id": 76, "title": "Нравится ли тебе следовать точным инструкциям?", "rate": 1 },
        { "id": 77, "title": "Готов ли ты соблюдать технику безопасности?", "rate": 1 },
        { "id": 78, "title": "Интересен ли тебе монтаж инженерных систем?", "rate": 1 },
        { "id": 79, "title": "Готов ли ты к физическим нагрузкам?", "rate": 1 }
      ]
    },
    {
      "id": 2,
      "title": "Дизайн интерьера",
      "questions": [
        { "id": 80, "title": "Нравится ли тебе подбирать цвета и материалы?", "rate": 1 },
        { "id": 81, "title": "Интересуешься ли ты мебелью и освещением?", "rate": 1 },
        { "id": 82, "title": "Хочешь создавать уютные пространства?", "rate": 1 },
        { "id": 83, "title": "Умеешь ли ты рисовать или делать коллажи?", "rate": 1 },
        { "id": 84, "title": "Интересны ли тебе тренды дизайна?", "rate": 1 },
        { "id": 85, "title": "Готов ли ты общаться с клиентами и учитывать их вкусы?", "rate": 1 },
        { "id": 86, "title": "Хочешь разрабатывать проекты под бюджет?", "rate": 1 },
        { "id": 87, "title": "Нравится ли тебе делать рендеры и визуализации?", "rate": 1 },
        { "id": 88, "title": "Готов ли ты дорабатывать проекты по замечаниям?", "rate": 1 },
        { "id": 89, "title": "Интересует ли тебя эргономика и комфорт?", "rate": 1 }
      ]
    }
  ]
},
{
  "id": 3,
  "title": "Сельское хозяйство",
  "subscope": [
    {
      "id": 0,
      "title": "Растениеводство",
      "questions": [
        { "id": 90, "title": "Нравится ли тебе работать на земле?", "rate": 1 },
        { "id": 91, "title": "Интересны ли тебе растения и агрономия?", "rate": 1 },
        { "id": 92, "title": "Готов ли ты ухаживать за посадками?", "rate": 1 },
        { "id": 93, "title": "Интересуешься ли ты удобрениями и почвами?", "rate": 1 },
        { "id": 94, "title": "Хочешь получать урожай своими руками?", "rate": 1 },
        { "id": 95, "title": "Нравится ли тебе наблюдать за ростом растений?", "rate": 1 },
        { "id": 96, "title": "Интересен ли тебе процесс полива и ухода?", "rate": 1 },
        { "id": 97, "title": "Готов ли ты работать сезонно и по графику природы?", "rate": 1 },
        { "id": 98, "title": "Интересен ли тебе биологический контроль вредителей?", "rate": 1 },
        { "id": 99, "title": "Хочешь вести сельское хозяйство устойчиво и экологично?", "rate": 1 }
      ]
    },
    {
      "id": 1,
      "title": "Животноводство",
      "questions": [
        { "id": 100, "title": "Любишь ли ты животных?", "rate": 1 },
        { "id": 101, "title": "Готов ли ты ухаживать за животными каждый день?", "rate": 1 },
        { "id": 102, "title": "Интересны ли тебе болезни и здоровье животных?", "rate": 1 },
        { "id": 103, "title": "Хочешь разводить скот или птицу?", "rate": 1 },
        { "id": 104, "title": "Интересуешься ли кормлением и рационом?", "rate": 1 },
        { "id": 105, "title": "Готов ли ты к физическому труду и графику?", "rate": 1 },
        { "id": 106, "title": "Интересуешься ли ты животноводческой техникой?", "rate": 1 },
        { "id": 107, "title": "Хочешь повышать продуктивность фермы?", "rate": 1 },
        { "id": 108, "title": "Нравится ли тебе быть на свежем воздухе?", "rate": 1 },
        { "id": 109, "title": "Готов ли ты к эмоциональной привязанности к животным?", "rate": 1 }
      ]
    },
    {
      "id": 2,
      "title": "Агрономия и биотехнологии",
      "questions": [
        { "id": 110, "title": "Интересуешься ли ты селекцией растений?", "rate": 1 },
        { "id": 111, "title": "Нравятся ли тебе лабораторные исследования?", "rate": 1 },
        { "id": 112, "title": "Хочешь улучшать сорта и виды растений?", "rate": 1 },
        { "id": 113, "title": "Готов ли ты изучать генетику и микробиологию?", "rate": 1 },
        { "id": 114, "title": "Интересен ли тебе контроль за качеством продуктов?", "rate": 1 },
        { "id": 115, "title": "Хочешь помогать природе и экологии через технологии?", "rate": 1 },
        { "id": 116, "title": "Интересуешься ли биоферментами и удобрениями?", "rate": 1 },
        { "id": 117, "title": "Готов ли ты работать в полевых и лабораторных условиях?", "rate": 1 },
        { "id": 118, "title": "Нравится ли тебе анализ данных и графики?", "rate": 1 },
        { "id": 119, "title": "Хочешь применять науку в реальной жизни?", "rate": 1 }
      ]
    }
  ]
},
{
  "id": 4,
  "title": "Обслуживание и сервис",
  "subscope": [
    {
      "id": 0,
      "title": "Гостиничное дело",
      "questions": [
        { "id": 120, "title": "Нравится ли тебе помогать людям в путешествии?", "rate": 1 },
        { "id": 121, "title": "Интересуешься ли ты организацией отдыха гостей?", "rate": 1 },
        { "id": 122, "title": "Готов ли ты работать в гостинице?", "rate": 1 },
        { "id": 123, "title": "Любишь ли ты следить за чистотой и порядком?", "rate": 1 },
        { "id": 124, "title": "Интересны ли тебе языки и общение с иностранцами?", "rate": 1 },
        { "id": 125, "title": "Готов ли ты решать конфликты и помогать клиентам?", "rate": 1 },
        { "id": 126, "title": "Хочешь управлять персоналом или отелем?", "rate": 1 },
        { "id": 127, "title": "Интересуешься ли ты стандартами сервиса?", "rate": 1 },
        { "id": 128, "title": "Готов ли ты работать в смену или в выходные?", "rate": 1 },
        { "id": 129, "title": "Нравится ли тебе создавать уютную атмосферу?", "rate": 1 }
      ]
    },
    {
      "id": 1,
      "title": "Ресторанное дело",
      "questions": [
        { "id": 130, "title": "Нравится ли тебе готовить или подавать еду?", "rate": 1 },
        { "id": 131, "title": "Интересуешься ли ты кухнями мира?", "rate": 1 },
        { "id": 132, "title": "Готов ли ты работать официантом или поваром?", "rate": 1 },
        { "id": 133, "title": "Хочешь открыть своё кафе или ресторан?", "rate": 1 },
        { "id": 134, "title": "Готов ли ты к быстрой и активной работе?", "rate": 1 },
        { "id": 135, "title": "Интересны ли тебе стандарты обслуживания и вкусы гостей?", "rate": 1 },
        { "id": 136, "title": "Готов ли ты работать в горячем цеху?", "rate": 1 },
        { "id": 137, "title": "Хочешь учиться у опытных шеф-поваров?", "rate": 1 },
        { "id": 138, "title": "Интересны ли тебе кулинарные тренды и презентация блюд?", "rate": 1 },
        { "id": 139, "title": "Нравится ли тебе работать с людьми и улыбаться гостям?", "rate": 1 }
      ]
    },
    {
      "id": 2,
      "title": "Парикмахерское и косметическое дело",
      "questions": [
        { "id": 140, "title": "Нравится ли тебе делать причёски или макияж?", "rate": 1 },
        { "id": 141, "title": "Интересуешься ли ты модой и стилем?", "rate": 1 },
        { "id": 142, "title": "Готов ли ты работать руками с инструментами?", "rate": 1 },
        { "id": 143, "title": "Хочешь помогать людям чувствовать себя красивыми?", "rate": 1 },
        { "id": 144, "title": "Готов ли ты учиться новым техникам и трендам?", "rate": 1 },
        { "id": 145, "title": "Интересны ли тебе курсы и мастер-классы от профи?", "rate": 1 },
        { "id": 146, "title": "Готов ли ты быть вежливым и слушать пожелания клиента?", "rate": 1 },
        { "id": 147, "title": "Хочешь открыть собственный салон?", "rate": 1 },
        { "id": 148, "title": "Интересует ли тебя уход за кожей и волосами?", "rate": 1 },
        { "id": 149, "title": "Нравится ли тебе видеть результат своей работы сразу?", "rate": 1 }
      ]
    }
  ]
}

])

const formStore = useFormStore()
const step = ref(1)
const currentScope = ref()
const scopeID = ref()
const subscopeID = ref()

const goNext = (scopeId:number,subscopeId:number) => {
    if(step.value === 1){
        const curr = scope.value.find(elem => elem.id === scopeId)
        const currScope = curr?.subscope.find(elem => elem.id === subscopeId)
        scopeID.value = scopeId
        subscopeID.value = subscopeId
        currentScope.value = currScope
        step.value = 2
    }else if(step.value === 2){
        const curr = scope.value.find(elem => elem.id === scopeID.value)
        const currScope = curr?.subscope.find(elem => elem.id === subscopeID.value)
        formStore.addForm({title:currScope?.title,skills:currScope?.questions})
        console.log(currScope)
    }else if(step.value === 3){

    }
}
const changeQuestionRate = (qId:number,rate:number) => {
    const current = scope.value.find(elem => elem.id === scopeID.value)
    const currentSub = current?.subscope.find(elem => elem.id === subscopeID.value)
    const currQ = currentSub?.questions.find(elem => elem.id === qId)
    if(currQ){
        currQ.rate = rate
    }
}
</script>
<template>
    <div class="w-full">
        <div class="flex flex-col border-solid border-gray border-[1px] rounded-md shadow-lg p-6 gap-6">
            <div class="flex flex-col gap-1">
                <div class="w-full flex gap-1">
                    <div class="flex flex-col w-full items-center justify-center gap-1">
                        <span>Шаг 1</span>
                        <div class="w-full  h-2 rounded-l-full" :class="step >= 1 ? 'bg-accent' : 'bg-gray'"></div>
                    </div>
                    
                    <div class="flex flex-col w-full items-center justify-center gap-1">
                        <span >Шаг 2</span>
                        <div class="w-full  h-2 rounded-r-full" :class="step >= 2 ? 'bg-accent' : 'bg-gray'"></div>
                    </div>
                </div>
                <div>
                    <StepOne :data="scope" v-if="step === 1" :goNext="goNext" />
                    <StepTwo :data="currentScope" v-else-if="step === 2" :goNext="goNext" :changeQuestionRate="changeQuestionRate" />
                </div>
                
            </div>
            
        </div>
    </div>
</template>